## **å·¥å•åˆ†ç±» & AI è§£ææ–¹æ¡ˆ**

åœ¨ **å®å°Šç”µå•†è¿ç»´å¹³å°** é‡Œï¼Œç”¨æˆ·çš„è¯·æ±‚æ¶‰åŠå¤šä¸ªå…·ä½“å·¥å•ç±»å‹ï¼Œå¦‚ **å‘å¸ƒå·¥å•ã€èµ„æºç”³è¯·å·¥å•ã€æ•°æ®åº“å·¥å•ã€æ‰©å®¹å·¥å•ç­‰**ã€‚  
AI éœ€è¦è§£æç”¨æˆ·è¾“å…¥ï¼Œ**è‡ªåŠ¨åŒ¹é…åˆé€‚çš„å·¥å•ç±»å‹**ï¼Œå¹¶ **ç”Ÿæˆæ ‡å‡†åŒ– JSON ç»“æ„** ä»¥ä¾¿æäº¤è‡³ **è¿ç»´ç³»ç»Ÿ**ã€‚  

---

## **1. å·¥å•åˆ†ç±»**

| å·¥å•ç±»å‹ | é€‚ç”¨åœºæ™¯ | å…³é”®å­—æ®µ |
|---------|---------|---------|
| **å‘å¸ƒå·¥å•** | ä»£ç ä¸Šçº¿ã€ç°åº¦å‘å¸ƒ | åº”ç”¨åç§°ã€ç¯å¢ƒã€ç‰ˆæœ¬ã€å®¡æ‰¹äºº |
| **èµ„æºç”³è¯·å·¥å•** | æ–°å¢æœåŠ¡å™¨ã€æ‰©å±•å­˜å‚¨ | èµ„æºç±»å‹ã€è§„æ ¼ã€æ•°é‡ |
| **æ•°æ®åº“ DML å·¥å•** | æ•°æ®æ’å…¥ã€æ›´æ–°ã€åˆ é™¤ | æ•°æ®åº“ã€SQL è¯­å¥ã€å½±å“èŒƒå›´ |
| **æ•°æ®åº“ DDL å·¥å•** | æ–°å»ºè¡¨ã€ç´¢å¼•å˜æ›´ | æ•°æ®åº“ã€è¡¨ç»“æ„ã€å˜æ›´å†…å®¹ |
| **Nginx å·¥å•** | è´Ÿè½½å‡è¡¡ã€åŸŸåè§£æ | Nginx é…ç½®ã€ç›®æ ‡ä¸»æœº |
| **æŠ€æœ¯æ”¯æŒå·¥å•** | ä¸šåŠ¡ç–‘é—®ã€æŠ€æœ¯æ•…éšœ | é—®é¢˜æè¿°ã€è”ç³»äºº |
| **è¿ç»´è‡ªå®šä¹‰å·¥å•** | å…¶ä»–ç‰¹æ®Šè¿ç»´éœ€æ±‚ | éœ€æ±‚è¯¦æƒ… |
| **K8s æ‰©å®¹å·¥å•** | Pod æ‰©å±•ã€HPA å˜æ›´ | åº”ç”¨åç§°ã€å‰¯æœ¬æ•° |
| **è™šæ‹Ÿæœºæ‰©å®¹å·¥å•** | CPU / å†…å­˜ / ç£ç›˜æ‰©å±• | æœåŠ¡å™¨ã€æ‰©å±•è§„æ ¼ |
| **åŸŸåè§£æå·¥å•** | DNS å˜æ›´ | åŸŸåã€è§£æç›®æ ‡ |

---

## **2. AI è§£æ & JSON ç”Ÿæˆ**

### **ç¤ºä¾‹ 1ï¼šä»£ç å‘å¸ƒå·¥å•**

**ç”¨æˆ·è¾“å…¥**

```
æˆ‘è¦ä¸Šçº¿ç”µå•†å‰ç«¯ v2.1.3 åˆ°ç”Ÿäº§ç¯å¢ƒï¼Œèƒ½å¸®æˆ‘ç”Ÿæˆå·¥å•å—ï¼Ÿ
```

**AI è§£æ**

```json
{
    "intent": "å‘å¸ƒå·¥å•",
    "query_keywords": ["ä¸Šçº¿", "ç”µå•†å‰ç«¯", "v2.1.3", "ç”Ÿäº§ç¯å¢ƒ"],
    "ticket": {
        "type": "å‘å¸ƒå·¥å•",
        "title": "ç”µå•†å‰ç«¯ v2.1.3 å‘å¸ƒ",
        "description": "ç”µå•†å‰ç«¯ v2.1.3 éœ€è¦ä¸Šçº¿åˆ°ç”Ÿäº§ç¯å¢ƒã€‚",
        "application": "ç”µå•†å‰ç«¯",
        "environment": "ç”Ÿäº§",
        "version": "v2.1.3",
        "approver": "è¿ç»´ç»ç†",
        "priority": "é«˜",
        "assignee": "å‘å¸ƒå›¢é˜Ÿ",
        "status": "å¾…å®¡æ‰¹"
    }
}
```

---

### **ç¤ºä¾‹ 2ï¼šæ•°æ®åº“ DML å·¥å•**

**ç”¨æˆ·è¾“å…¥**

```
è¯·å¸®æˆ‘æ‰§è¡Œ SQLï¼šUPDATE users SET status='active' WHERE id=1001ï¼Œåœ¨ç”¨æˆ·æ•°æ®åº“é‡Œæ“ä½œã€‚
```

**AI è§£æ**

```json
{
    "intent": "æ•°æ®åº“ DML å·¥å•",
    "query_keywords": ["SQL", "UPDATE", "users", "status", "active"],
    "ticket": {
        "type": "æ•°æ®åº“ DML å·¥å•",
        "title": "æ‰§è¡Œ SQL å˜æ›´",
        "description": "åœ¨ç”¨æˆ·æ•°æ®åº“æ‰§è¡Œ SQL è¯­å¥ï¼šUPDATE users SET status='active' WHERE id=1001ã€‚",
        "database": "ç”¨æˆ·æ•°æ®åº“",
        "sql_statement": "UPDATE users SET status='active' WHERE id=1001",
        "approver": "DBA",
        "priority": "ä¸­",
        "assignee": "æ•°æ®åº“ç®¡ç†å‘˜",
        "status": "å¾…å®¡æ‰¹"
    }
}
```

---

### **ç¤ºä¾‹ 3ï¼šK8s æ‰©å®¹å·¥å•**

**ç”¨æˆ·è¾“å…¥**

```
K8s è®¢å•æœåŠ¡ CPU è´Ÿè½½å¤ªé«˜ï¼Œè¯·æ‰©å®¹ 3 ä¸ª podã€‚
```

**AI è§£æ**

```json
{
    "intent": "K8s æ‰©å®¹å·¥å•",
    "query_keywords": ["K8s", "è®¢å•æœåŠ¡", "CPU è´Ÿè½½", "æ‰©å®¹", "3 ä¸ª pod"],
    "ticket": {
        "type": "K8s æ‰©å®¹å·¥å•",
        "title": "K8s è®¢å•æœåŠ¡æ‰©å®¹",
        "description": "è®¢å•æœåŠ¡å½“å‰ CPU è´Ÿè½½è¿‡é«˜ï¼Œéœ€è¦æ‰©å®¹ 3 ä¸ª podã€‚",
        "application": "è®¢å•æœåŠ¡",
        "replica_increase": 3,
        "approver": "SRE",
        "priority": "é«˜",
        "assignee": "K8s è¿ç»´å›¢é˜Ÿ",
        "status": "å¾…å®¡æ‰¹"
    }
}
```

---

## **3. ä»£ç å®ç°**

### **AI è§£æç”¨æˆ·è¾“å…¥**

```python
import json
from openai import OpenAI

client = OpenAI(
    api_key="your-api-key",
    base_url="https://api.deepseek.com"
)

system_prompt = """
ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½è¿ç»´åŠ©æ‰‹ï¼Œè´Ÿè´£è§£æç”¨æˆ·è¾“å…¥ï¼Œå¹¶å°†å…¶æ˜ å°„åˆ°ä»¥ä¸‹å·¥å•ç±»åˆ«ï¼š
- "å‘å¸ƒå·¥å•"
- "èµ„æºç”³è¯·å·¥å•"
- "æ•°æ®åº“ DML å·¥å•"
- "æ•°æ®åº“ DDL å·¥å•"
- "Nginx å·¥å•"
- "æŠ€æœ¯æ”¯æŒå·¥å•"
- "è¿ç»´è‡ªå®šä¹‰å·¥å•"
- "K8s æ‰©å®¹å·¥å•"
- "è™šæ‹Ÿæœºæ‰©å®¹å·¥å•"
- "åŸŸåè§£æå·¥å•"

ç„¶åï¼Œä½ éœ€è¦è¿”å›ä¸€ä¸ª **æ ‡å‡†åŒ– JSON**ï¼š
{
    "intent": "K8s æ‰©å®¹å·¥å•",
    "query_keywords": ["K8s", "è®¢å•æœåŠ¡", "CPU è´Ÿè½½", "æ‰©å®¹"],
    "ticket": {
        "type": "K8s æ‰©å®¹å·¥å•",
        "title": "K8s è®¢å•æœåŠ¡æ‰©å®¹",
        "description": "è®¢å•æœåŠ¡ CPU è´Ÿè½½è¿‡é«˜ï¼Œéœ€è¦æ‰©å®¹ 3 ä¸ª podã€‚",
        "application": "è®¢å•æœåŠ¡",
        "replica_increase": 3,
        "approver": "SRE",
        "priority": "é«˜",
        "assignee": "K8s è¿ç»´å›¢é˜Ÿ",
        "status": "å¾…å®¡æ‰¹"
    }
}
"""

def generate_ticket(user_input):
    messages = [
        {"role": "system", "content": system_prompt},
        {"role": "user", "content": user_input}
    ]
    
    response = client.chat.completions.create(
        model="deepseek-chat",
        messages=messages,
        response_format={"type": "json_object"}
    )
    
    return json.loads(response.choices[0].message.content)

# ç¤ºä¾‹æµ‹è¯•
user_query = "K8s è®¢å•æœåŠ¡ CPU è´Ÿè½½å¤ªé«˜ï¼Œè¯·æ‰©å®¹ 3 ä¸ª podã€‚"
parsed_response = generate_ticket(user_query)
print(json.dumps(parsed_response, indent=2, ensure_ascii=False))
```

---

## **4. å·¥å•ç³»ç»Ÿå¯¹æ¥**

å¯ä»¥ç›´æ¥æäº¤ JSON ç»“æœåˆ° Jiraã€ITSM æˆ–å†…éƒ¨å·¥å•ç³»ç»Ÿã€‚

```python
import requests

def submit_ticket(ticket_data):
    jira_api_url = "https://your-jira-instance.com/rest/api/2/issue"
    headers = {"Content-Type": "application/json"}
    
    jira_payload = {
        "fields": {
            "project": {"key": "OPS"},
            "summary": ticket_data["ticket"]["title"],
            "description": ticket_data["ticket"]["description"],
            "priority": {"name": ticket_data["ticket"]["priority"]},
            "assignee": {"name": ticket_data["ticket"]["assignee"]},
            "status": ticket_data["ticket"]["status"]
        }
    }

    response = requests.post(jira_api_url, json=jira_payload, headers=headers, auth=("user", "password"))
    return response.json()

# æäº¤å·¥å•
ticket_response = submit_ticket(parsed_response)
print(ticket_response)
```

---

## **5. ä¸šåŠ¡ä»·å€¼**

âœ… **è‡ªåŠ¨å·¥å•åŒ¹é…**ï¼šè§£æç”¨æˆ·éœ€æ±‚ï¼Œè‡ªåŠ¨å½’ç±»åˆ°æ­£ç¡®çš„å·¥å•ç±»å‹  
âœ… **å‡å°‘äººå·¥æ“ä½œ**ï¼šè‡ªåŠ¨å¡«å……å·¥å•ä¿¡æ¯ï¼Œå‡å°‘æ‰‹å·¥è¾“å…¥é”™è¯¯  
âœ… **é›†æˆç›‘æ§ç³»ç»Ÿ**ï¼šä¸ Prometheusã€DeepFlowã€ELK ç»“åˆï¼Œå®ç°è‡ªåŠ¨æ‰©å®¹ & æ•…éšœåˆ†æ  
âœ… **é€‚é…å®å°Šç”µå•†ä¸šåŠ¡**ï¼šæ”¯æŒ **å‘å¸ƒã€æ•°æ®åº“ã€K8sã€Nginxã€è™šæ‹Ÿæœºã€åŸŸå** ç­‰å…¨æ–¹ä½è¿ç»´éœ€æ±‚  

ğŸš€ **ä¸‹ä¸€æ­¥**ï¼šå¯æ¥å…¥ **Slack / é£ä¹¦æœºå™¨äºº**ï¼Œè®© AI ç›´æ¥åœ¨ IM é‡Œç”Ÿæˆå·¥å•ï¼
